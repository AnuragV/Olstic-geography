<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Country Scrabble Challenge</title>
<style>
  body { margin:0; font-family:sans-serif; background:#eee; text-align:center; }
  #game { display:flex; flex-direction:column; align-items:center; padding:10px; }
  #board { display:grid; grid-template: repeat(15,40px) / repeat(15,40px);
           border:2px solid #444; }
  .cell {
    width:40px; height:40px; box-sizing:border-box; position:relative;
    border-radius:6px; display:flex; align-items:center; justify-content:center;
    font-weight:bold; font-size:1rem;
  }
  .mult-DL { background:#cceeff; }
  .mult-TL { background:#66ccff; }
  .mult-DW { background:#ffcccc; }
  .mult-TW { background:#cc0000; color:#fff; }
  .mult-NORMAL { background:#ddd; }
  .cell.highlighted { border:2px solid #003399; }
  .tile { width:40px;height:40px;border:1px solid #666;display:inline-flex;
          align-items:center;justify-content:center;background:#fff;
          border-radius:6px;margin:2px; cursor:grab; user-select:none; }
  #rack { margin:10px; display:flex; flex-wrap:wrap; justify-content:center; }
  #submit { margin:10px; padding:8px 16px; font-size:1rem; }
  #info { margin:10px; font-size:1.1rem; }
</style>
</head>
<body>
<div id="game">
  <div id="board"></div>
  <button id="submit">Submit Word</button>
  <div id="rack"></div>
  <div id="info">
    Score: <span id="score">0</span> | Time Left: <span id="timer">10:00</span>
  </div>
</div>

<script>
const tileScores = {A:1,B:3,C:3,D:2,E:1,F:4,G:2,H:4,I:1,J:8,K:5,L:1,M:3,N:1,O:1,
  P:3,Q:10,R:1,S:1,T:1,U:1,V:4,W:4,X:8,Y:4,Z:10};
const countries = ["AFGHANISTAN","ALBANIA","ALGERIA","ANDORRA","ANGOLA","ANTIGUA","ARGENTINA","ARMENIA",
  "AUSTRALIA","AUSTRIA","AZERBAIJAN","BAHAMAS","BAHRAIN","BANGLADESH","BARBADOS","BELARUS",
  "BELGIUM","BELIZE","BENIN","BHUTAN","BOLIVIA","BOSNIA","BOTSWANA","BRAZIL","BRUNEI",
  "BULGARIA","BURKINA","BURUNDI","CABOVERDE","CAMBODIA","CAMEROON","CANADA","CENTRALAFRICANREPUBLIC",
  "CHAD","CHILE","CHINA","COLOMBIA","COMOROS","CONGO","COSTARICA","CROATIA","CUBA","CYPRUS","CZECHIA",
  "DENMARK","DJIBOUTI","DOMINICA","DOMINICANREPUBLIC","ECUADOR","EGYPT","ELSALVADOR","EQUATORIALGUINEA",
  "ERITREA","ESTONIA","ESWATINI","ETHIOPIA","FIJI","FINLAND","FRANCE","GABON","GAMBIA","GEORGIA",
  "GERMANY","GHANA","GREECE","GRENADA","GUATEMALA","GUINEA","GUINEABISSAU","GUYANA","HAITI","HONDURAS",
  "HUNGARY","ICELAND","INDIA","INDONESIA","IRAN","IRAQ","IRELAND","ISRAEL","ITALY","IVORYCOAST",
  "JAMAICA","JAPAN","JORDAN","KAZAKHSTAN","KENYA","KIRIBATI","KOREA","KOSOVO","KUWAIT","KYRGYZSTAN",
  "LAOS","LATVIA","LEBANON","LESOTHO","LIBERIA","LIBYA","LIECHTENSTEIN","LITHUANIA","LUXEMBOURG",
  "MADAGASCAR","MALAWI","MALAYSIA","MALDIVES","MALI","MALTA","MARSHALLISLANDS","MAURITANIA",
  "MAURITIUS","MEXICO","MICRONESIA","MOLDOVA","MONACO","MONGOLIA","MONTENEGRO","MOROCCO","MOZAMBIQUE",
  "MYANMAR","NAMIBIA","NAURU","NEPAL","NETHERLANDS","NEWZEALAND","NICARAGUA","NIGER","NIGERIA",
  "NORTHKOREA","NORTHMACEDONIA","NORWAY","OMAN","PAKISTAN","PALAU","PALESTINE","PANAMA",
  "PAPUANEWGUINEA","PARAGUAY","PERU","PHILIPPINES","POLAND","PORTUGAL","QATAR","ROMANIA","RUSSIA",
  "RWANDA","SAINTKITTS","SAINTLUCIA","SAINTVINCENT","SAMOA","SANMARINO","SAOTOMEANDPRINCIPE",
  "SAUDIARABIA","SENEGAL","SERBIA","SEYCHELLES","SIERRALEONE","SINGAPORE","SLOVAKIA","SLOVENIA",
  "SOLOMONISLANDS","SOMALIA","SOUTHAFRICA","SOUTHKOREA","SOUTHSUDAN","SPAIN","SRI LANKA",
  "SUDAN","SURINAME","SWEDEN","SWITZERLAND","SYRIA","TAIWAN","TAJIKISTAN","TANZANIA","THAILAND",
  "TIMORLESTE","TOGO","TONGA","TRINIDADANDTOBAGO","TUNISIA","TURKEY","TURKMENISTAN","TUVALU",
  "UGANDA","UKRAINE","UNITEDARABEMIRATES","UNITEDKINGDOM","UNITEDSTATES","URUGUAY","UZBEKISTAN",
  "VANUATU","VATICANCITY","VENEZUELA","VIETNAM","YEMEN","ZAMBIA","ZIMBABWE"
]; 

let placed = []; // [{letter, r,c, elem, baseConnected:false}]
let score = 0, timeLeft = 600, timer;

const mult = {
  "0,0":"TW","0,3":"DL","0,7":"TW","0,11":"DL","0,14":"TW",
  "1,1":"DW","1,5":"TL","1,9":"TL","1,13":"DW",
  "2,2":"DW","2,6":"DL","2,8":"DL","2,12":"DW",
  "3,0":"DL","3,3":"DW","3,7":"DL","3,11":"DW","3,14":"DL",
  "4,4":"DW","4,10":"DW",
  "5,1":"TL","5,5":"TL","5,9":"TL","5,13":"TL",
  "6,2":"DL","6,6":"DL","6,8":"DL","6,12":"DL",
  "7,0":"TW","7,3":"DL","7,7":"DW","7,11":"DL","7,14":"TW",
  "8,2":"DL","8,6":"DL","8,8":"DL","8,12":"DL",
  "9,1":"TL","9,5":"TL","9,9":"TL","9,13":"TL",
  "10,4":"DW","10,10":"DW",
  "11,0":"DL","11,3":"DW","11,7":"DL","11,11":"DW","11,14":"DL",
  "12,2":"DW","12,6":"DL","12,8":"DL","12,12":"DW",
  "13,1":"DW","13,5":"TL","13,9":"TL","13,13":"DW",
  "14,0":"TW","14,3":"DL","14,7":"TW","14,11":"DL","14,14":"TW"
};

const boardEl = document.getElementById("board");
for(let r=0;r<15;r++)for(let c=0;c<15;c++){
  const cell = document.createElement("div");
  cell.className = "cell";
  const key=`${r},${c}`, m=mult[key]||"NORMAL";
  cell.classList.add("mult-"+m);
  cell.dataset.r=r; cell.dataset.c=c;
  cell.ondrop = drop; cell.ondragover = e=>e.preventDefault();
  boardEl.appendChild(cell);
}

function drop(e){
  e.preventDefault();
  const letter=e.dataTransfer.getData("text");
  if(!letter) return;
  const cell=e.currentTarget;
  if(cell.textContent) return; // occupied
  cell.textContent=letter;
  cell.classList.add("placed");
  placed.push({letter, r:+cell.dataset.r, c:+cell.dataset.c, elem:cell});
  renderRack();
}

function renderRack(){
  const rack = document.getElementById("rack");
  rack.innerHTML="";
  const used = placed.map(p=>p.letter);
  "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(l=>{
    if(used.filter(x=>x===l).length < 26){ // unlimited but prevent duplicates in rack view
      const t=document.createElement("div");
      t.textContent=l; t.className="tile"; t.draggable=true;
      t.ondragstart=e=>e.dataTransfer.setData("text",l);
      rack.appendChild(t);
    }
  });
}

document.getElementById("submit").onclick = ()=>{
  if(!placed.length) return alert("Place at least one tile!");
  const word=placed.map(p=>p.letter).join("");
  if(!countries.includes(word)){
    alert("Not a valid country name.");
    return;
  }
  // connectivity check: first move allowed anywhere; subsequent must touch existing
  if(score>0){
    const ok = placed.some(p=>{
      return [[1,0],[-1,0],[0,1],[0,-1]].some(d=>{
        const nr=p.r+d[0], nc=p.c+d[1];
        return gridState[nr]?.[nc];
      });
    });
    if(!ok) return alert("New word must connect existing tiles.");
  }
  // scoring
  let ws=1, sum=0;
  placed.forEach(p=>{
    const s=tileScores[p.letter];
    const m=mult[`${p.r},${p.c}`];
    sum += s * (m==="DL"?2:m==="TL"?3:1);
    if(m==="DW") ws*=2;
    if(m==="TW") ws*=3;
    p.elem.classList.add("highlighted");
    p.elem.ondragover=null; p.elem.ondrop=null;
  });
  score += sum * ws;
  document.getElementById("score").innerText=score;
  // mark grid state
  placed.forEach(p=> gridState[p.r][p.c]=true);
  placed=[];
  renderRack();
};

const gridState=Array.from({length:15},()=>Array(15).fill(false));
renderRack();

// Timer
timer = setInterval(()=>{
  const min=Math.floor(timeLeft/60), sec=timeLeft%60;
  document.getElementById("timer").innerText=
    `${min.toString().padStart(2,"0")}:${sec.toString().padStart(2,"0")}`;
  if(timeLeft--<=0){
    clearInterval(timer);
    alert(`Time's up! Final score: ${score}`);
    boardEl.querySelectorAll(".cell").forEach(c=>c.ondrop=c.ondragover=null);
  }
},1000);
</script>
</body>
</html>
