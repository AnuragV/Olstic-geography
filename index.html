<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Break the Code: Arrange the Balloons</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Segoe UI', sans-serif;
      background: #121212;
      color: #eee;
      text-align: center;
    }

    h1 {
      font-size: 32px;
      margin-bottom: 10px;
      color: #ffc107;
    }

    .game-area {
      background: #1e1e1e;
      padding: 20px;
      border-radius: 12px;
      max-width: 900px;
      margin: 0 auto;
    }

    .mode-controls {
      display: flex;
      justify-content: flex-start;
      gap: 10px;
      margin-bottom: 15px;
    }

    .mode-btn {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
      background: #555;
      color: #eee;
      transition: background 0.3s;
    }

    .mode-btn.active {
      background: #ffc107;
      color: #000;
    }

    .top-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .status-box {
      background: #ffc107;
      color: #000;
      padding: 10px 15px;
      border-radius: 6px;
      font-weight: bold;
      font-size: 18px;
    }

    .info-btn {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #ffc107;
      color: #000;
      font-weight: bold;
      font-size: 18px;
      border: none;
      cursor: pointer;
    }

    .balloon-container {
      display: flex;
      justify-content: space-around;
      margin: 20px 0;
      height: 200px;
    }

    .bowl {
      position: relative;
      flex: 1;
      max-width: 100px;
      background: rgba(255,255,255,0.1);
      border-radius: 50% 50% 0 0;
      padding-top: 20px;
    }

    .string {
      position: absolute;
      width: 2px;
      background: #000;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
    }

    .balloon {
      position: absolute;
      top: 25px;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 50%;
      cursor: grab;
      transition: transform 0.2s;
    }

    .balloon:active {
      transform: translateX(-50%) scale(1.2);
    }

    .controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
    }

    .controls button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s;
    }

    .submit-btn {
      background: #ffc107;
      color: #000;
    }

    .new-code-btn {
      background: #fff;
      color: #000;
    }

    .reveal-btn {
      background: #6a5acd;
      color: #fff;
    }

    .leaderboard {
      margin: 20px 0;
      text-align: center;
    }

    .leaderboard ul {
      list-style: none;
      padding: 0;
    }

    .leaderboard h3 {
      color: #ffc107;
    }

    /* Modal and code display omitted for brevity */
  </style>
</head>
<body>
  <h1>ðŸŽˆ Break the Code: Arrange the Balloons ðŸŽˆ</h1>
  <div class="game-area">
    <div class="mode-controls">
      <button class="mode-btn active" onclick="setMode('easy')">Easy</button>
      <button class="mode-btn" onclick="setMode('medium')">Medium</button>
      <button class="mode-btn" onclick="setMode('hard')">Hard</button>
    </div>
    <div class="top-controls">
      <div class="status-box" id="attemptsBox">Attempts: 0</div>
      <div class="status-box" id="correctBox">0 balloons are placed correctly</div>
      <button class="info-btn" onclick="toggleInstructions()">?</button>
    </div>
    <div class="balloon-container" id="bowlArea"></div>
    <div class="controls">
      <button class="submit-btn" onclick="submitGuess()">Submit Guess</button>
      <button class="new-code-btn" onclick="startGame()">New Code</button>
      <button class="reveal-btn" onclick="revealCode()">Reveal Code</button>
    </div>
    <div class="leaderboard" id="leaderboard">
      <h3>Easy Leaderboard</h3>
      <ul id="easyLeaderboard"></ul>
      <h3>Medium Leaderboard</h3>
      <ul id="mediumLeaderboard"></ul>
      <h3>Hard Leaderboard</h3>
      <ul id="hardLeaderboard"></ul>
    </div>
  </div>

  <!-- Modal & code display omitted -->

  <script>
    const MODES = {
      easy: ['red','yellow','white','blue','green'],
      medium: ['red','yellow','white','blue','green','pink','purple'],
      hard: ['red','yellow','white','blue','green','pink','purple','orange','cyan']
    };
    let mode = 'easy', code = [], currentOrder = [], attempts = 0;
    let username = prompt("Enter your username:")||"Anonymous";

    function setMode(m) {
      mode = m;
      document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.toggle('active', btn.textContent.toLowerCase()===m));
      startGame();
    }

    function shuffle(arr) {
      return arr.slice().sort(() => Math.random()-0.5);
    }

    function startGame() {
      const colors = MODES[mode];
      code = shuffle(colors);
      do { currentOrder = shuffle(colors); } while(currentOrder.some((c,i)=>c===code[i]));
      attempts = 0;
      render(); updateLeaderboards();
    }

    function render() {
      document.getElementById('attemptsBox').textContent = `Attempts: ${attempts}`;
      const correct = currentOrder.reduce((a,c,i)=>a+(c===code[i]),0);
      document.getElementById('correctBox').textContent = `${correct} balloons are placed correctly`;

      const area = document.getElementById('bowlArea');
      area.innerHTML = '';
      const n = currentOrder.length;
      const totalW = area.clientWidth;
      const gap = 10;
      const w = (totalW - gap*(n-1))/n;
      const h = w*1.2;
      for(let i=0;i<n;i++){
        const bowl = document.createElement('div'); bowl.className='bowl';
        bowl.style.width=w+'px'; bowl.style.height=h*0.2+'px'; bowl.dataset.i=i;
        bowl.addEventListener('dragover',e=>e.preventDefault());
        bowl.addEventListener('drop',drop);
        const str = document.createElement('div'); str.className='string'; str.style.height=h*0.2+'px'; bowl.appendChild(str);
        const b = document.createElement('div'); b.className='balloon '+currentOrder[i];
        b.draggable=true; b.dataset.c=currentOrder[i];
        b.style.width=w*0.6+'px'; b.style.height=w*0.6+'px'; b.style.top=h*0.2+'px';
        b.addEventListener('dragstart',e=>e.dataTransfer.setData('text',e.target.dataset.c));
        bowl.appendChild(b);
        area.appendChild(bowl);
      }
    }

    function drop(e){
      const to=+e.currentTarget.dataset.i;
      const c=e.dataTransfer.getData('text');
      const from=currentOrder.indexOf(c);
      [currentOrder[from],currentOrder[to]]=[currentOrder[to],currentOrder[from]];
      render();
    }

    function submitGuess(){
      attempts++; render();
      if(currentOrder.every((c,i)=>c===code[i])){ alert(`ðŸŽ‰ Done in ${attempts} moves!`); saveLeaderboard(mode); updateLeaderboards(); }
    }

    function saveLeaderboard(m){
      const key='board_'+m;
      let s=JSON.parse(localStorage.getItem(key)||'[]');
      s.push({u:username,a:attempts});
      s.sort((x,y)=>x.a-y.a);
      localStorage.setItem(key,JSON.stringify(s.slice(0,5)));
    }

    function updateLeaderboards(){
      ['easy','medium','hard'].forEach(m=>{
        const list=document.getElementById(m+'Leaderboard');
        list.innerHTML='';
        JSON.parse(localStorage.getItem('board_'+m)||'[]').forEach((e,i)=>{
          const li=document.createElement('li');
          li.textContent=`${i+1}. ${e.u} â€” ${e.a} moves`;
          list.appendChild(li);
        });
      });
    }

    startGame();
  </script>
</body>
</html>
